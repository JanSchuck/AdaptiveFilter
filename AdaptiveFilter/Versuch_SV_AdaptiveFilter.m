%**************************************************************************
% Load signal
%**************************************************************************
[x,fx_s_in] = audioread('x.wav');
[z,fz_s_in] = audioread('z.wav');

%[x1,fx1_s_in] = audioread('x1.wav');
%[d1,fd1_s_in] = audioread('d1.wav');

%[x2,fx2_s_in] = audioread('x2.wav');
%[d2,fd2_s_in] = audioread('d2.wav');

%[x_heli,x_heli_s_in] = audioread('x_heli.wav');
%[z_heli,z_heli_s_in] = audioread('z_heli.wav');


%**************************************************************************
%% Main initialization
%**************************************************************************
N=512
alpha         = 0.2;

%**************************************************************************
% Adaptive Filterung
%**************************************************************************
[y,shat,h]= NLSM(x,z,alpha,N);


%ERLE=estERLE(z,shat,16*N);
%n=length(ERLE);
%t=n/fx_s_in;
%**************************************************************************
%% Ausgabe
%**************************************************************************

soundsc(shat,16000);


%**************************************************************************
%% Plotting
%**************************************************************************
%test= [1:10000,1]
%subplot(2,1,1)
%plot(test,x2(1:10001))
%subplot(2,1,2)
%plot(test,x1(1:10001))

%**************************************************************************
%% Aufgabe 2b pwelch
%**************************************************************************
%pwelch




